<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
<mapper namespace="UserDAO">

	<!-- 로그인 처리 -->
	<select id ="getUser" resultType="user">
		<![CDATA[
			SELECT * 
			FROM member 
			where m_id = #{m_id}
		]]>
	</select>
	
	<!-- 아이디 중복 검사 결과 처리 -->
	<select id="idCheck" parameterType="user" resultType="int">
		<![CDATA[
			SELECT	COUNT(*) 
			FROM	member 
			WHERE	m_id = #{m_id}
		]]>
	</select>
	
	<!-- 회원가입 처리 -->
	<insert id="signUp" parameterType="user">
		<![CDATA[
			INSERT INTO member (m_id, m_name, m_pass, m_level, j_ip) 
			VALUES (#{m_id}, #{m_name}, #{m_pass}, 2, #{j_ip})
		]]>
	</insert>
	
	<!-- 비밀번호 변경전 기존 비밀번호 확인 -->
	<select id="passCheck" parameterType="user" resultType="int">
		<![CDATA[
			SELECT	COUNT(*) 
			FROM	member 
			WHERE	m_id = #{m_id} AND m_pass = #{m_pass} 
		]]>
	</select>
	
	<!-- 비밀번호 변경 -->
	<update id="passChange" parameterType="user">
		<![CDATA[
			UPDATE	member
			SET		m_pass	= #{m_pass}
			WHERE	m_id	= #{m_id}
		]]>
		
	</update>
	
	<!-- 게시글 정보 -->
	<select id="tableInfo" resultType="board">
		<![CDATA[
			SELECT		b_idx, bc_code, b_num, b_reply, m_id, m_name, m_pass, m_ip, title, content, writetime, b_cnt, b_good 
			FROM		bd_board 
			WHERE		m_id = #{m_id} 
			ORDER BY	writetime 
		]]>
	</select>
	
	<!-- 댓글 정보 -->
	<select id="commentInfo" resultType="comment">
		<![CDATA[
			SELECT		co_idx, bc_code, b_num, m_id, m_name, m_pass, co_content, co_writedate, co_depth, co_group, m_ip 
			FROM		bd_comment 
			WHERE		m_id = #{m_id} 
			ORDER BY	co_writedate 
		]]>
	</select>
</mapper>